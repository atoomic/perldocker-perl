From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Nicolas Rochelemagne <rochelemagne@cpanel.net>
Date: Mon, 5 Nov 2018 15:24:50 -0600
Subject: [PATCH 26/30] add test for CVE-2018-12015 (RT #133250)

---
 .../cpan/Archive-Tar/t/04_resolved_issues.t   | 28 +++++++++++++++++++
 1 file changed, 28 insertions(+)

diff --git a/SOURCES/perl/cpan/Archive-Tar/t/04_resolved_issues.t b/SOURCES/perl/cpan/Archive-Tar/t/04_resolved_issues.t
index 4991d9a6..70210baf 100644
--- a/SOURCES/perl/cpan/Archive-Tar/t/04_resolved_issues.t
+++ b/SOURCES/perl/cpan/Archive-Tar/t/04_resolved_issues.t
@@ -279,3 +279,31 @@ use_ok( $FileClass );
 	ok( -e 'white_space   ',    "	<white_space   > should exist" );
 	unlink foreach ('white_space   ', 'white_space');
 }
+
+### bug 97748
+### retain leading '/' for absolute pathnames.
+{   ok( 1,                      "Testing bug 97748" );
+	my $path= '/absolute/path';
+	my $tar = $Class->new;
+	isa_ok( $tar, $Class,       "   Object" );
+	my $file;
+
+	ok( $file = $tar->add_data( $path, '' ),
+		"       Added $path" );
+
+	ok( $file->full_path eq $path,
+		"	Paths mismatch <" . $file->full_path . "> ne <$path>" );
+}
+
+### bug 103279
+### retain trailing whitespace on filename
+{   ok( 1,                      "Testing bug 103279" );
+	my $tar = $Class->new;
+	isa_ok( $tar, $Class,       "   Object" );
+	ok( $tar->add_data( 'white_space   ', '' ),
+				    "   Add file <white_space   > containing filename with trailing whitespace");
+	ok( $tar->extract(),        "	Extract filename with trailing whitespace" );
+	ok( ! -e 'white_space',     "	<white_space> should not exist" );
+	ok( -e 'white_space   ',    "	<white_space   > should exist" );
+	unlink foreach ('white_space   ', 'white_space');
+}
